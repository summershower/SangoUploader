"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[925,907],{46896:function(te,b,e){e.r(b),e.d(b,{default:function(){return C}});var v="data:image/png;base64,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",N=e(46126),M=e(67880),l=e.n(M),k=e(61430),s=e(93236),Z=e(31026),g=e.n(Z),n=e(62086),E=e(2236);l().extend(E).locale(g());function C(r){var t=r.url,d=r.state,u=r.file,o=r.time,f=r.size,F=r.id,Q=r.setFilesList,y=r.isCDNAddress,p=(0,s.useRef)(null);(0,s.useEffect)(function(){var Y=new IntersectionObserver(function(A){if(A[0].isIntersecting){var c;(c=p.current)===null||c===void 0||c.classList.add("flipAnimation"),Y.disconnect()}});Y.observe(p.current)},[p.current]);function ie(Y){Y.stopPropagation(),Q(function(A){return A.filter(function(c){return c.id!==F})}),(0,k.Oy)(F)}return d==="PENDING"?(0,n.jsxs)("div",{className:"file-item flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",ref:p,children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm  ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(t??"")?URL.createObjectURL(u):v}),(0,n.jsx)("div",{className:"flex-1 flex items-center ml-4 break-all",children:"\u4E0A\u4F20\u4E2D..."})]}):d==="SUCCESS"?(0,n.jsxs)("div",{className:"file-item  relative flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",onClick:function(){var A;return(0,N.r0)((A=y?t:t==null?void 0:t.replace("https://cdn.meiqijiacheng.com/","https://sango-frankfurt.oss-accelerate.aliyuncs.com/"))!==null&&A!==void 0?A:"")},ref:p,children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(t||"")?t:v}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-start h-24 ml-4 ",children:[(0,n.jsx)("div",{children:y?t:t==null?void 0:t.replace("https://cdn.meiqijiacheng.com/","https://sango-frankfurt.oss-accelerate.aliyuncs.com/")}),(0,n.jsxs)("div",{className:"text-xs text-gray-400 mt-2",children:["\u6587\u4EF6\u5927\u5C0F: ",f/1024>1024?(f/1024/1024).toFixed(2)+"Mb":(f/1024).toFixed(2)+"kb","\xA0\xA0\xA0\u4E0A\u4F20\u65F6\u95F4\uFF1A",l()(o).format("YYYY-MM-DD HH:mm:ss")," (",l()(o).fromNow(),")"]})]}),(0,n.jsx)("div",{className:"closeBtn hidden absolute right-3 top-3 text-sm rounded-full bg-gray-400 transition-all w-5 h-5 text-white flex justify-center items-center hover:bg-red-400",onClick:ie,children:"X"})]}):(0,n.jsxs)("div",{className:"file-item flex p-3 mt-6 bg-red-100 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",ref:p,children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(t??"")?URL.createObjectURL(u):v}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-start h-24 ml-4 ",children:[(0,n.jsxs)("div",{children:[(u==null?void 0:u.name)||""," "]}),(0,n.jsxs)("div",{className:"text-xs text-gray-400 mt-2",children:["\u6587\u4EF6\u5927\u5C0F: ",f/1024>1024?(f/1024/1024).toFixed(2)+"Mb":(f/1024).toFixed(2)+"kb","\xA0\xA0\xA0\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5"]})]})]})}},39757:function(te,b,e){e.r(b),e.d(b,{default:function(){return Z}});var v=e(46686),N=e.n(v),M=e(25647),l=e(83768),k=e(93236),s=e(62086);function Z(g){var n=g.uploadDirectory,E=g.setUploadDirectory,C=g.isNeedHash,r=g.setIsNeedHash,t=function(p){r(p.target.checked)},d=(0,k.useState)(F()),u=N()(d,2),o=u[0],f=u[1];function F(){for(var y="",p=0;p<10;p++)y+=Math.random().toString(36).substr(2,1);return(0,s.jsxs)("span",{className:"text-blue-600",children:["-",y]})}var Q=(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"\u52FE\u9009\u54C8\u5E0C\u503C\uFF0C\u6587\u4EF6\u540D\u4F1A\u968F\u7740\u6587\u4EF6\u5185\u5BB9\u53D8\u5316\u800C\u53D8\u5316\u3002"}),(0,s.jsxs)("p",{children:["\u53EF\u4EE5\u7406\u89E3\u4E3A",(0,s.jsx)("span",{className:"text-red-400",children:"\u6BCF\u4E2A\u6587\u4EF6\u62E5\u6709\u72EC\u4E00\u65E0\u4E8C\u7684\u547D\u540D"}),"\u3002"]}),(0,s.jsx)("p",{children:"\u53EF\u4EE5\u907F\u514D\u5728\u76EE\u5F55\u76F8\u540C\u65F6\uFF0C\u4E0A\u4F20\u4E86\u540C\u540D\u6587\u4EF6\u628A\u4E4B\u524D\u7684\u6587\u4EF6\u8986\u76D6\u7684\u60C5\u51B5\u3002"}),(0,s.jsx)("p",{children:"\u5982\u679C\u5C31\u662F\u4E3A\u4E86\u4E0A\u4F20\u4E00\u4E2A\u65E5\u540E\u9700\u8981\u66FF\u6362\u7684\u6587\u4EF6\uFF1F\u53EF\u4EE5\u53D6\u6D88\u9009\u62E9\u3002"}),(0,s.jsx)("p",{children:"\u4E0D\u6E05\u695A?\u90A3\u5C31\u4E0D\u7528\u52A8\u3002"})]});return(0,s.jsxs)("div",{className:"flex-1 items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"\u914D\u7F6E\u9879\uFF1A"}),(0,s.jsxs)("div",{className:"flex items-center mt-8",children:[(0,s.jsx)("h2",{children:"\u4E0A\u4F20\u76EE\u5F55\uFF1A"}),(0,s.jsx)("b",{children:"/web/"}),(0,s.jsx)("input",{onChange:function(p){return E(p.target.value)},value:n,className:"border-transparent w-64 h-10 ml-2 pl-4 pr-4 bg-gray-200 rounded-md text-pink-600 text-2xl outline-none focus:ring focus:border-blue-200 focus:bg-gray-200 shadow-sm focus:shadow-md transition-all font-bold",type:"text","max-length":"20"}),(0,s.jsx)("b",{className:"ml-2",children:"/"})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(M.Z,{content:Q,title:"\u8FD9\u662F\u4EC0\u4E48\u73A9\u610F\u513F\uFF1F",children:(0,s.jsx)(l.Z,{checked:C,onChange:t,children:"\u8FFD\u52A0\u6587\u4EF6\u54C8\u5E0C\u503C"})})}),(0,s.jsxs)("div",{className:"mt-4 text-gray-500",children:["\u6700\u7EC8\u8DEF\u5F84\u793A\u4F8B\uFF1A https://cdn.meiqijiahceng.com/web/",(0,s.jsx)("span",{className:"text-pink-600 font-bold",children:n?n+"/":""}),"simple",C?o:"",".png"]})]})}},6069:function(te,b,e){e.r(b),e.d(b,{default:function(){return E}});var v=e(94434),N=e.n(v),M=e(46686),l=e.n(M),k=e(93236),s=e(61430),Z=e(42140),g=e(62086),n=function(r){var t=r.filesList,d=r.activeDirectory,u=r.setActiveDirectory,o=r.setPage,f=r.setUploadDirectory,F=r.setFilesList,Q=(0,k.useState)({}),y=l()(Q,2),p=y[0],ie=y[1];(0,k.useEffect)(function(){for(var A={},c=0;c<t.length;c++)A[t[c].directory]?(A[t[c].directory].count++,A[t[c].directory].lastModified<t[c].time&&(A[t[c].directory].lastModified=t[c].time)):A[t[c].directory]={count:1,lastModified:t[c].time,directory:t[c].directory},ie(A)},[t.length]);function Y(A,c){c.stopPropagation();for(var I=N()(t),q=function(ne){if(t[ne].directory===A){(0,s.Oy)(t[ne].id);var fe=I.findIndex(function(oe){return oe.id===t[ne].id});I.splice(fe,1)}},$=0;$<t.length;$++)q($);F(I),u(""),o(1)}return t.length?(0,g.jsxs)("div",{className:"flex flex-wrap",children:[(0,g.jsxs)("div",{onClick:function(){u(""),o(1),f("test")},className:"mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(d===""&&"bg-blue-100"),children:["\u5168\u90E8(",t.length,")"]}),Object.entries(p).sort(function(A,c){return c[1].lastModified-A[1].lastModified}).map(function(A){var c=l()(A,2),I=c[0],q=c[1];return(0,g.jsxs)("div",{className:"tag-item relative mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(d===I&&"bg-blue-100"),onClick:function(){u(I),o(1),f(I)},children:[I,"(",q.count,")",(0,g.jsx)(Z.Z,{title:"\u5220\u9664".concat(I,"\u7684\u8BB0\u5F55\u5417\uFF1F"),onConfirm:function(le){return Y(I,le)},okText:"Yes",cancelText:"No",children:(0,g.jsx)("div",{className:"tagCloseBtn absolute text-xs rounded-full bg-gray-300 transition-all w-5 h-5 text-white flex justify-center items-center hover:bg-red-400 hover:w-6 hover:h-6",children:"X"})})]},I)})]}):(0,g.jsx)("div",{})},E=n},90925:function(te,b,e){e.r(b),e.d(b,{default:function(){return He}});var v=e(94434),N=e.n(v),M=e(35290),l=e.n(M),k=e(46686),s=e.n(k),Z=e(411),g=e.n(Z),n=e(93236),E=e(39757),C=e(46896),r=e(93275),t=e.n(r),d=e(9189),u=e.n(d),o=e(58482),f=e.n(o),F=e(30365),Q=e.n(F),y=function(){return new Promise(function(H,j){Q().get("https://gapi.meiqijiacheng.com/configure/getSTS?objectName=web").then(function(R){H(R.data.data)}).catch(function(R){j(R)})})},p=e(21156),ie=null;function Y(){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function G(){return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",new Promise(function(){var R=_asyncToGenerator(_regeneratorRuntime().mark(function O(T,L){var U;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,getOSSConfig;case 3:U=x.sent,T(U),x.next=10;break;case 7:x.prev=7,x.t0=x.catch(0),L(x.t0);case 10:case"end":return x.stop()}},O,null,[[0,7]])}));return function(O,T){return R.apply(this,arguments)}}()));case 1:case"end":return j.stop()}},G)})),A.apply(this,arguments)}var c=function(){function G(){u()(this,G),t()(this,"oss",null),t()(this,"invalidTime",0)}return f()(G,[{key:"getOSS",value:function(){var j=this;return new Promise(function(){var R=g()(l()().mark(function O(T,L){return l()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(+new Date<j.invalidTime)){S.next=4;break}T(j.oss),S.next=13;break;case 4:return S.prev=4,S.next=7,j.initOSS();case 7:T(j.oss),S.next=13;break;case 10:S.prev=10,S.t0=S.catch(4),L(S.t0);case 13:case"end":return S.stop()}},O,null,[[4,10]])}));return function(O,T){return R.apply(this,arguments)}}())}},{key:"initOSS",value:function(){var j=this;return new Promise(function(){var R=g()(l()().mark(function O(T,L){var U,S,x,ce,se,de;return l()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.prev=0,B.next=3,y();case 3:U=B.sent,S=U.aLiYunHost,x=U.accessKeyId,ce=U.accessKeySecret,se=U.bucketName,de=U.securityToken,j.oss=new p({region:S.replace(".aliyuncs.com",""),accessKeyId:x,accessKeySecret:ce,stsToken:de,bucket:se}),j.invalidTime=+new Date+36e5,T(!0),B.next=14;break;case 10:B.prev=10,B.t0=B.catch(0),console.log(B.t0),L("\u8BF7\u6C42OSS\u914D\u7F6E\u51FA\u9519");case 14:case"end":return B.stop()}},O,null,[[0,10]])}));return function(O,T){return R.apply(this,arguments)}}())}}]),G}(),I=e(61430),q=e(29485),$=e(70387),le=e(25647),ne=e(90002),fe=e(32214),oe=e(46126),Ze=e(6069),i=e(62086),Qe=new c,De;function He(){function G(){return H.apply(this,arguments)}function H(){return H=g()(l()().mark(function a(){return l()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,Qe.getOSS();case 3:De=m.sent,Fe("FINISHED"),nt(),m.next=11;break;case 8:m.prev=8,m.t0=m.catch(0),Fe("ERROR");case 11:case"end":return m.stop()}},a,null,[[0,8]])})),H.apply(this,arguments)}(0,n.useEffect)(function(){G(),(0,I.XZ)().then(function(){(0,I.vO)().then(function(a){ee(a)})})},[]);var j=(0,n.useState)("test"),R=s()(j,2),O=R[0],T=R[1],L=(0,n.useRef)(O);(0,n.useEffect)(function(){L.current=O},[O]);var U=(0,n.useState)(!0),S=s()(U,2),x=S[0],ce=S[1],se=(0,n.useRef)(x);(0,n.useEffect)(function(){se.current=x},[x]);var de=(0,n.useState)("LOADING"),he=s()(de,2),B=he[0],Fe=he[1],Ke=function(){switch(B){case"LOADING":return(0,i.jsx)("h1",{className:"text-xl text-gray-400",children:"\u6B63\u5728\u52A0\u8F7DOSS\u7EC4\u4EF6..."});case"FINISHED":return(0,i.jsx)("h1",{className:"text-xl text-green-600",children:"OSS\u521D\u59CB\u5316\u5B8C\u6BD5\u2714"});case"ERROR":return(0,i.jsx)("h1",{className:"text-xl text-pink-600 cursor-pointer",onClick:function(){return location.reload()},children:"\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u8BD5\xD7"})}},ze=(0,n.useState)(!1),ye=s()(ze,2),ae=ye[0],Ie=ye[1],we=(0,n.useState)([]),je=s()(we,2),_=je[0],ee=je[1],Ge=(0,n.useState)(0),be=s()(Ge,2),Xe=be[0],Je=be[1],We=q.ZP.useMessage(),Be=s()(We,2),me=Be[0],Ye=Be[1],Pe=(0,n.useRef)(ae);(0,n.useEffect)(function(){Pe.current=ae},[ae]);function Ne(a){Ie(!0);for(var h=[],m=function(z){h.push(function(){return Ve(a.target.files[z],Math.floor(Math.random()*1e16),L.current)})},X=0;X<a.target.files.length;X++)m(X);var J=new oe.Kk(h,10,function(K,z,W,P,w){Je(Math.floor((w-W-z)/w*100)),(K==="FAILED"||K==="SUCCESS")&&Pe&&(P===0?me.open({type:"success",content:"\u6210\u529F\u4E0A\u4F20".concat(w,"\u4E2A\u6587\u4EF6")}):w>P?me.open({type:"warning",content:"\u6210\u529F\u4E0A\u4F20".concat(w-P,"\u4E2A\u6587\u4EF6\uFF0C\u5931\u8D25").concat(P,"\u4E2A")}):me.open({type:"error",content:"".concat(P,"\u4E2A\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}),setTimeout(function(){Ie(!1),a.target.value=""},700))});J.start()}var ge=(0,n.useRef)(_);(0,n.useEffect)(function(){ge.current=_},[_]);function Ve(a,h,m){return ve.apply(this,arguments)}function ve(){return ve=g()(l()().mark(function a(h,m,X){var J,K,z,W,P,w,V,xe,Me;return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(D.prev=0,!se.current){D.next=7;break}return D.next=4,(0,oe.oP)(h);case 4:J=D.sent,D.next=8;break;case 7:J=h.name;case 8:return K={time:+new Date,id:m,file:h,size:h.size,state:"PENDING",directory:X},ee(function(ue){return[K].concat(N()(ue))}),D.next=12,De.put("/web/".concat(L.current?L.current+"/":"")+J,h);case 12:z=D.sent,W="https://cdn.meiqijiacheng.com/"+z.name,P=N()(ge.current),w=P.find(function(ue){return ue.id===m}),w.state="SUCCESS",w.url=W,V=0;case 19:if(!(V<P.length)){D.next=27;break}if(!(P[V].size===h.size&&P[V].url===W&&P[V].id!==m)){D.next=24;break}return(0,I.Oy)(P[V].id),P.splice(V,1),D.abrupt("break",27);case 24:V++,D.next=19;break;case 27:ee(N()(P)),Te(L.current),(0,I.B7)(w),D.next=39;break;case 32:throw D.prev=32,D.t0=D.catch(0),xe=N()(ge.current),Me=xe.find(function(ue){return ue.id===m}),Me.state="FAILED",ee(xe),new Error(D.t0);case 39:case"end":return D.stop()}},a,null,[[0,32]])})),ve.apply(this,arguments)}var Ee=(0,n.useRef)(null);function $e(){if(!/^([0-9a-zA-Z]+[/]?[0-9a-zA-Z]+)+$/.test(L.current)&&L.current!==""){q.ZP.error("\u8DEF\u5F84\u53EA\u80FD\u542B\u6709\u82F1\u6587\u548C\u6570\u5B57");return}Ee.current&&Ee.current.click()}function pe(){return Se===""?_.sort(function(a,h){return h.time-a.time}):_.filter(function(a){return a.directory===Se}).sort(function(a,h){return h.time-a.time})}var qe=(0,n.useState)(1),Oe=s()(qe,2),Ce=Oe[0],Le=Oe[1],_e=(0,n.useState)(20),ke=s()(_e,2),Ae=ke[0],et=ke[1],tt=(0,n.useState)(""),Re=s()(tt,2),Se=Re[0],Te=Re[1];function nt(){var a,h,m,X,J,K,z,W;(a=document.querySelector("#dragBox"))===null||a===void 0||a.addEventListener("dragenter",st,!1),(h=document.querySelector("#dragMask"))===null||h===void 0||h.addEventListener("dragleave",rt,!1),(m=document.querySelector("#dragMask"))===null||m===void 0||m.addEventListener("drop",at,!1),(X=document.querySelector("#dragMask"))===null||X===void 0||X.addEventListener("dragenter",re,!1),(J=document.querySelector("#dragBox"))===null||J===void 0||J.addEventListener("dragleave",re,!1),(K=document.querySelector("#dragMask"))===null||K===void 0||K.addEventListener("dragover",re,!1),(z=document.querySelector("#dragBox"))===null||z===void 0||z.addEventListener("dragover",re,!1),(W=document.querySelector("#dragBox"))===null||W===void 0||W.addEventListener("drop",re,!1)}function st(a){a.preventDefault(),a.stopPropagation(),document.querySelector("#dragMask").style.display="flex"}function at(a){a.preventDefault(),a.stopPropagation(),document.querySelector("#dragMask").style.display="none",Ne({target:{files:a.dataTransfer.files}})}function rt(a){a.preventDefault(),a.stopPropagation(),document.querySelector("#dragMask").style.display="none"}function re(a){a.preventDefault(),a.stopPropagation()}var ut=(0,n.useState)(!0),Ue=s()(ut,2),it=Ue[0],lt=Ue[1],ot=(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:["\u5BF9\u4E8E\u6D3B\u52A8\u8D44\u6E90\u7B49",(0,i.jsx)("span",{className:"text-red-400",children:"\u4F1A\u88AB\u591A\u4EBA\u91CD\u590D\u8BBF\u95EE"}),"\u7684\u8D44\u6E90\uFF0C\u8BF7\u52FE\u9009CDN\u5730\u5740\u3002"]}),(0,i.jsx)("p",{children:"\u5426\u5219\u8BF7\u4F7F\u7528\u6E90\u7AD9\u5730\u5740\u3002"}),(0,i.jsx)("p",{children:"CDN\u5730\u5740\u7684\u6587\u4EF6\u9996\u6B21\u8BBF\u95EE\u65F6\u9700\u8981\u5230\u6E90\u7AD9\u83B7\u53D6\uFF0C\u901F\u5EA6\u53EF\u80FD\u8F83\u6162\uFF0C\u8FD9\u662F\u6B63\u5E38\u7684\u3002"}),(0,i.jsx)("p",{children:"\u4E0D\u6E05\u695A?\u90A3\u5C31\u4E0D\u7528\u52A8\u3002"})]});return(0,i.jsxs)("div",{className:"w-3/4 bg-white rounded-xl shadow-lg mt-8 ml-auto mr-auto p-8",children:[Ke(),(0,i.jsxs)("div",{className:"relative flex mt-8 bg-gray-50 p-8 rounded-xl",id:"dragBox",children:[(0,i.jsx)(E.default,{uploadDirectory:O,setUploadDirectory:T,isNeedHash:x,setIsNeedHash:ce}),ae?(0,i.jsx)($.Z,{className:"mt-4 mr-8 w-32 h-32",type:"circle",percent:Xe}):(0,i.jsx)("div",{className:"uploadBtn flex mt-4 mr-8 items-center justify-center w-32 h-32 rounded-full cursor-pointer text-white shadow-xl text-xl  ".concat(B!=="FINISHED"&&"hidden"),onClick:$e,children:(0,i.jsxs)("svg",{t:"1669963956354",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5794",width:"50",height:"50",children:[(0,i.jsx)("path",{d:"M873.411765 481.882353a60.235294 60.235294 0 0 1 120.470588 0v283.467294C993.882353 908.107294 878.953412 1024 736.858353 1024H287.141647C145.046588 1024 30.117647 908.107294 30.117647 765.349647V481.882353a60.235294 60.235294 0 1 1 120.470588 0v283.467294C150.588235 841.788235 211.847529 903.529412 287.141647 903.529412h449.716706C812.152471 903.529412 873.411765 841.788235 873.411765 765.349647V481.882353z","p-id":"5795",fill:"#dbdbdb"}),(0,i.jsx)("path",{d:"M451.764706 60.235294m60.235294 0l0 0q60.235294 0 60.235294 60.235294l0 602.352941q0 60.235294-60.235294 60.235295l0 0q-60.235294 0-60.235294-60.235295l0-602.352941q0-60.235294 60.235294-60.235294Z","p-id":"5796",fill:"#dbdbdb"}),(0,i.jsx)("path",{d:"M508.988235 170.345412L338.522353 340.751059a60.235294 60.235294 0 0 1-85.172706-85.172706L466.401882 42.586353a60.235294 60.235294 0 0 1 85.172706 0l212.931765 212.992a60.235294 60.235294 0 1 1-85.172706 85.172706L508.988235 170.345412z","p-id":"5797",fill:"#dbdbdb"})]})}),ae?"":(0,i.jsx)("div",{className:"flipAnimation absolute right-14 bottom-8 text-gray-400 text-sm ".concat(B!=="FINISHED"&&"hidden"),children:"\u70B9\u51FB\u4E0A\u4F20\u6216\u62D6\u66F3\u6587\u4EF6\u81F3\u6B64"}),(0,i.jsx)("div",{id:"dragMask",className:"rounded-xl",children:"\u653E\u624B\u5373\u53EF\u4E0A\u4F20"})]}),(0,i.jsx)(Ze.default,{filesList:_,activeDirectory:Se,setActiveDirectory:Te,setPage:Le,setUploadDirectory:T,setFilesList:ee}),pe().length?(0,i.jsxs)("div",{className:"mt-8 bg-gray-50 p-8 rounded-xl",children:[(0,i.jsxs)("div",{className:"flex justify-between item-center",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:"\u6587\u4EF6\u5217\u8868:"}),(0,i.jsx)(le.Z,{content:ot,title:"\u8FD9\u662F\u4EC0\u4E48\u73A9\u610F\u513F\uFF1F",children:(0,i.jsx)(ne.Z,{className:"btn-switch",checkedChildren:"CDN",unCheckedChildren:"\u6E90\u7AD9",defaultChecked:!0,onChange:function(h){return lt(h)}})})]}),(0,i.jsx)("div",{children:pe().slice((Ce-1)*Ae,(Ce-1)*Ae+Ae).map(function(a){return(0,i.jsx)(C.default,{file:a.file,url:a.url,state:a.state,time:a.time,size:a.size,id:a.id,setFilesList:ee,isCDNAddress:it},a.id)})}),(0,i.jsx)(fe.Z,{className:"flex justify-center mt-5",current:Ce,defaultCurrent:1,total:pe().length,pageSize:Ae,onChange:function(h,m){Le(h),et(m)}})]}):"",(0,i.jsx)("input",{className:"invisible",type:"file",onChange:Ne,multiple:!0,ref:Ee}),Ye]})}},61430:function(te,b,e){e.d(b,{B7:function(){return s},Oy:function(){return g},XZ:function(){return k},vO:function(){return Z}});var v="uploadRecords",N="SangoUploader",M=2,l=null;function k(){return new Promise(function(n,E){var C=window.indexedDB.open(N,M);C.onupgradeneeded=function(r){var t;if(l=r==null||(t=r.target)===null||t===void 0?void 0:t.result,!l.objectStoreNames.contains(v))var d=l.createObjectStore(v,{keyPath:"id"})},C.onsuccess=function(r){var t;l=r==null||(t=r.target)===null||t===void 0?void 0:t.result,n(!0)},C.onerror=function(r){E(r)}})}function s(n){delete n.file;var E=l.transaction(v,"readwrite").objectStore(v).add(n);E.onsuccess=function(){console.log("\u5199\u5165",E.result)},E.onerror=function(C){console.log(C,"\u5199\u5165\u5931\u8D25")}}function Z(){return new Promise(function(n,E){var C=l.transaction(v).objectStore(v),r=C.getAll();r.onsuccess=function(t){n(t.target.result)}})}function g(n){var E=l.transaction(v,"readwrite").objectStore(v).delete(n);E.onsuccess=function(){console.log("\u5220\u9664\u6210\u529F",E.result)},E.onerror=function(C){console.log(C,"\u5220\u9664\u5931\u8D25")}}},46126:function(te,b,e){e.d(b,{Kk:function(){return r},oP:function(){return E},r0:function(){return C}});var v=e(9189),N=e.n(v),M=e(58482),l=e.n(M),k=e(93275),s=e.n(k),Z=e(34847),g=e.n(Z),n=e(29485);function E(t){return new Promise(function(d,u){var o=new FileReader;o.readAsArrayBuffer(t),o.onload=function(f){var F,Q=f.target.result,y=new(g()).ArrayBuffer().append(Q).end(),p=(F=/\.([a-zA-Z0-9]+)$/.exec(t.name))===null||F===void 0?void 0:F[1];d(t.name.replace("."+p,"")+"-"+y.substr(-9)+"."+p)},o.onerror=function(f){u(f)}})}function C(t){var d=document.createElement("input");d.value=t,document.body.appendChild(d),d.select(),document.execCommand("Copy"),document.body.removeChild(d),n.ZP.success("\u590D\u5236URL\u6210\u529F")}var r=function(){function t(d){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,o=arguments.length>2?arguments[2]:void 0;N()(this,t),s()(this,"maxConcurrencyLimit",5),s()(this,"tasks",[]),s()(this,"processingTasks",[]),s()(this,"failedTasks",[]),s()(this,"state","PENDING"),s()(this,"processCallback",void 0),s()(this,"total",0),this.maxConcurrencyLimit=u,this.tasks=d,this.total=d.length,this.processCallback=o,this.handleCallback()}return l()(t,[{key:"start",value:function(){for(this.state="PROCESSING";this.processingTasks.length<this.maxConcurrencyLimit&&this.tasks.length;)this.handleOneTask();var u=Promise.race(this.processingTasks);this.handleRace(u)}},{key:"handleRace",value:function(u){var o=this,f=function(){o.tasks.length&&o.processingTasks.length<o.maxConcurrencyLimit&&(o.handleOneTask(),o.handleRace(Promise.race(o.processingTasks)))};u.then(f,f)}},{key:"handleOneTask",value:function(){var u=this,o=this.tasks.shift(),f=o();f.then(function(){u.processingTasks.splice(u.processingTasks.findIndex(function(F){return F===f}),1),u.checkFinallyState()},function(F){console.log(F);var Q=u.processingTasks.findIndex(function(y){return y===f});u.processingTasks.splice(Q,1),u.failedTasks.push(o),u.checkFinallyState()}),this.processingTasks.push(f)}},{key:"checkFinallyState",value:function(){!this.tasks.length&&!this.processingTasks.length?(this.failedTasks.length?this.state="FAILED":this.state="SUCCESS",this.handleCallback()):this.handleCallback()}},{key:"handleCallback",value:function(){this.processCallback&&this.processCallback(this.state,this.processingTasks.length,this.tasks.length,this.failedTasks.length,this.total)}}]),t}()}}]);
