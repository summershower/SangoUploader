"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[925],{46896:function(se,j,e){e.r(j),e.d(j,{default:function(){return I}});var p="data:image/png;base64,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",k=e(46126),Z=e(67880),i=e.n(Z),A=e(61430),u=e(93236),B=e(31026),h=e.n(B),n=e(62086),v=e(2236);i().extend(v).locale(h());function I(a){var t=a.url,l=a.state,r=a.file,o=a.time,c=a.size,S=a.id,D=a.setFilesList,P=(0,u.useRef)(null);(0,u.useEffect)(function(){var Y=new IntersectionObserver(function(q){if(q[0].isIntersecting){var f;(f=P.current)===null||f===void 0||f.classList.add("flipAnimation"),Y.disconnect()}});Y.observe(P.current)},[P.current]);function W(Y){Y.stopPropagation(),D(function(q){return q.filter(function(f){return f.id!==S})}),(0,A.Oy)(S)}return l==="PENDING"?(0,n.jsxs)("div",{className:"file-item flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",ref:P,children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm  ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(t??"")?URL.createObjectURL(r):p}),(0,n.jsx)("div",{className:"flex-1 flex items-center ml-4 break-all",children:"\u4E0A\u4F20\u4E2D..."})]}):l==="SUCCESS"?(0,n.jsxs)("div",{className:"file-item  relative flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",onClick:function(){return(0,k.r0)(t??"")},ref:P,children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(t||"")?t:p}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-start h-24 ml-4 ",children:[(0,n.jsxs)("div",{children:[t," "]}),(0,n.jsxs)("div",{className:"text-xs text-gray-400 mt-2",children:["\u6587\u4EF6\u5927\u5C0F: ",c/1024>1024?(c/1024/1024).toFixed(2)+"Mb":(c/1024).toFixed(2)+"kb","\xA0\xA0\xA0\u4E0A\u4F20\u65F6\u95F4\uFF1A",i()(o).format("YYYY-MM-DD HH:mm:ss")," (",i()(o).fromNow(),")"]})]}),(0,n.jsx)("div",{className:"closeBtn hidden absolute right-3 top-3 text-sm rounded-full bg-gray-400 transition-all w-5 h-5 text-white flex justify-center items-center hover:bg-red-400",onClick:W,children:"X"})]}):(0,n.jsxs)("div",{className:"file-item flex p-3 mt-6 bg-red-100 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",ref:P,children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(t??"")?URL.createObjectURL(r):p}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-start h-24 ml-4 ",children:[(0,n.jsxs)("div",{children:[(r==null?void 0:r.name)||""," "]}),(0,n.jsxs)("div",{className:"text-xs text-gray-400 mt-2",children:["\u6587\u4EF6\u5927\u5C0F: ",c/1024>1024?(c/1024/1024).toFixed(2)+"Mb":(c/1024).toFixed(2)+"kb","\xA0\xA0\xA0\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5"]})]})]})}},39757:function(se,j,e){e.r(j),e.d(j,{default:function(){return u}});var p=e(46686),k=e.n(p),Z=e(83768),i=e(93236),A=e(62086);function u(B){var h=B.uploadDirectory,n=B.setUploadDirectory,v=B.isNeedHash,I=B.setIsNeedHash,a=function(D){I(D.target.checked)},t=(0,i.useState)(c()),l=k()(t,2),r=l[0],o=l[1];function c(){for(var S="",D=0;D<10;D++)S+=Math.random().toString(36).substr(2,1);return(0,A.jsxs)("span",{className:"text-blue-600",children:["-",S]})}return(0,A.jsxs)("div",{className:"flex-1 items-center",children:[(0,A.jsx)("h1",{className:"text-3xl font-bold",children:"\u914D\u7F6E\u9879\uFF1A"}),(0,A.jsxs)("div",{className:"flex items-center mt-8",children:[(0,A.jsx)("h2",{children:"\u4E0A\u4F20\u76EE\u5F55\uFF1A"}),(0,A.jsx)("b",{children:"/web/"}),(0,A.jsx)("input",{onChange:function(D){return n(D.target.value)},value:h,className:"border-transparent w-64 h-10 ml-2 pl-4 pr-4 bg-gray-200 rounded-md text-pink-600 text-2xl outline-none focus:ring focus:border-blue-200 focus:bg-gray-200 shadow-sm focus:shadow-md transition-all font-bold",type:"text","max-length":"20"}),(0,A.jsx)("b",{className:"ml-2",children:"/"})]}),(0,A.jsx)("div",{className:"mt-4",children:(0,A.jsx)(Z.Z,{checked:v,onChange:a,children:"\u8FFD\u52A0\u6587\u4EF6\u54C8\u5E0C\u503C"})}),(0,A.jsxs)("div",{className:"mt-4 text-gray-500",children:["\u6700\u7EC8\u8DEF\u5F84\u793A\u4F8B\uFF1A https://cdn.meiqijiahceng.com/web/",(0,A.jsx)("span",{className:"text-pink-600 font-bold",children:h?h+"/":""}),"simple",v?r:"",".png"]})]})}},6069:function(se,j,e){e.r(j),e.d(j,{default:function(){return v}});var p=e(94434),k=e.n(p),Z=e(46686),i=e.n(Z),A=e(93236),u=e(61430),B=e(23876),h=e(62086),n=function(a){var t=a.filesList,l=a.activeDirectory,r=a.setActiveDirectory,o=a.setPage,c=a.setUploadDirectory,S=a.setFilesList,D=(0,A.useState)({}),P=i()(D,2),W=P[0],Y=P[1];(0,A.useEffect)(function(){for(var f={},E=0;E<t.length;E++)f[t[E].directory]?(f[t[E].directory].count++,f[t[E].directory].lastModified<t[E].time&&(f[t[E].directory].lastModified=t[E].time)):f[t[E].directory]={count:1,lastModified:t[E].time,directory:t[E].directory},Y(f)},[t.length]);function q(f,E){E.stopPropagation();for(var b=k()(t),_=function(ee){if(t[ee].directory===f){(0,u.Oy)(t[ee].id);var Ae=b.findIndex(function(m){return m.id===t[ee].id});b.splice(Ae,1)}},$=0;$<t.length;$++)_($);S(b),r(""),o(1)}return t.length?(0,h.jsxs)("div",{className:"flex flex-wrap",children:[(0,h.jsxs)("div",{onClick:function(){r(""),o(1),c("test")},className:"mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(l===""&&"bg-blue-100"),children:["\u5168\u90E8(",t.length,")"]}),Object.entries(W).sort(function(f,E){return E[1].lastModified-f[1].lastModified}).map(function(f){var E=i()(f,2),b=E[0],_=E[1];return(0,h.jsxs)("div",{className:"tag-item relative mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(l===b&&"bg-blue-100"),onClick:function(){r(b),o(1),c(b)},children:[b,"(",_.count,")",(0,h.jsx)(B.Z,{title:"\u5220\u9664".concat(b,"\u7684\u8BB0\u5F55\u5417\uFF1F"),onConfirm:function(le){return q(b,le)},okText:"Yes",cancelText:"No",children:(0,h.jsx)("div",{className:"tagCloseBtn absolute text-xs rounded-full bg-gray-300 transition-all w-5 h-5 text-white flex justify-center items-center hover:bg-red-400 hover:w-6 hover:h-6",children:"X"})})]},b)})]}):(0,h.jsx)("div",{})},v=n},90925:function(se,j,e){e.r(j),e.d(j,{default:function(){return Me}});var p=e(94434),k=e.n(p),Z=e(35290),i=e.n(Z),A=e(46686),u=e.n(A),B=e(411),h=e.n(B),n=e(93236),v=e(39757),I=e(46896),a=e(93275),t=e.n(a),l=e(9189),r=e.n(l),o=e(58482),c=e.n(o),S=e(30365),D=e.n(S),P=function(){return new Promise(function(Q,F){D().get("https://gapi.meiqijiacheng.com/configure/getSTS?objectName=web").then(function(T){Q(T.data.data)}).catch(function(T){F(T)})})},W=e(21156),Y=null;function q(){return f.apply(this,arguments)}function f(){return f=_asyncToGenerator(_regeneratorRuntime().mark(function w(){return _regeneratorRuntime().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",new Promise(function(){var T=_asyncToGenerator(_regeneratorRuntime().mark(function N(U,R){var M;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,getOSSConfig;case 3:M=x.sent,U(M),x.next=10;break;case 7:x.prev=7,x.t0=x.catch(0),R(x.t0);case 10:case"end":return x.stop()}},N,null,[[0,7]])}));return function(N,U){return T.apply(this,arguments)}}()));case 1:case"end":return F.stop()}},w)})),f.apply(this,arguments)}var E=function(){function w(){r()(this,w),t()(this,"oss",null),t()(this,"invalidTime",0)}return c()(w,[{key:"getOSS",value:function(){var F=this;return new Promise(function(){var T=h()(i()().mark(function N(U,R){return i()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!(+new Date<F.invalidTime)){C.next=4;break}U(F.oss),C.next=13;break;case 4:return C.prev=4,C.next=7,F.initOSS();case 7:U(F.oss),C.next=13;break;case 10:C.prev=10,C.t0=C.catch(4),R(C.t0);case 13:case"end":return C.stop()}},N,null,[[4,10]])}));return function(N,U){return T.apply(this,arguments)}}())}},{key:"initOSS",value:function(){var F=this;return new Promise(function(){var T=h()(i()().mark(function N(U,R){var M,C,x,oe,ae,ce;return i()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,P();case 3:M=O.sent,C=M.aLiYunHost,x=M.accessKeyId,oe=M.accessKeySecret,ae=M.bucketName,ce=M.securityToken,F.oss=new W({region:C.replace(".aliyuncs.com",""),accessKeyId:x,accessKeySecret:oe,stsToken:ce,bucket:ae}),F.invalidTime=+new Date+36e5,U(!0),O.next=14;break;case 10:O.prev=10,O.t0=O.catch(0),console.log(O.t0),R("\u8BF7\u6C42OSS\u914D\u7F6E\u51FA\u9519");case 14:case"end":return O.stop()}},N,null,[[0,10]])}));return function(N,U){return T.apply(this,arguments)}}())}}]),w}(),b=e(61430),_=e(29485),$=e(70387),le=e(32214),ee=e(46126),Ae=e(6069),m=e(62086),Ue=new E,xe;function Me(){function w(){return Q.apply(this,arguments)}function Q(){return Q=h()(i()().mark(function s(){return i()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,Ue.getOSS();case 3:xe=d.sent,ye("FINISHED"),_e(),d.next=11;break;case 8:d.prev=8,d.t0=d.catch(0),ye("ERROR");case 11:case"end":return d.stop()}},s,null,[[0,8]])})),Q.apply(this,arguments)}(0,n.useEffect)(function(){w(),(0,b.XZ)().then(function(){(0,b.vO)().then(function(s){ne(s)})})},[]);var F=(0,n.useState)("test"),T=u()(F,2),N=T[0],U=T[1],R=(0,n.useRef)(N);(0,n.useEffect)(function(){R.current=N},[N]);var M=(0,n.useState)(!0),C=u()(M,2),x=C[0],oe=C[1],ae=(0,n.useRef)(x);(0,n.useEffect)(function(){ae.current=x},[x]);var ce=(0,n.useState)("LOADING"),fe=u()(ce,2),O=fe[0],ye=fe[1],Ze=function(){switch(O){case"LOADING":return(0,m.jsx)("h1",{className:"text-xl text-gray-400",children:"\u6B63\u5728\u52A0\u8F7DOSS\u7EC4\u4EF6..."});case"FINISHED":return(0,m.jsx)("h1",{className:"text-xl text-green-600",children:"OSS\u521D\u59CB\u5316\u5B8C\u6BD5\u2714"});case"ERROR":return(0,m.jsx)("h1",{className:"text-xl text-pink-600 cursor-pointer",onClick:function(){return location.reload()},children:"\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u8BD5\xD7"})}},Qe=(0,n.useState)(!1),Ie=u()(Qe,2),re=Ie[0],De=Ie[1],He=(0,n.useState)([]),be=u()(He,2),te=be[0],ne=be[1],ze=(0,n.useState)(0),Fe=u()(ze,2),Ke=Fe[0],we=Fe[1],Ge=_.ZP.useMessage(),je=u()(Ge,2),me=je[0],Xe=je[1],Pe=(0,n.useRef)(re);(0,n.useEffect)(function(){Pe.current=re},[re]);function Oe(s){De(!0);for(var g=[],d=function(z){g.push(function(){return Je(s.target.files[z],Math.floor(Math.random()*1e16),R.current)})},G=0;G<s.target.files.length;G++)d(G);var X=new ee.Kk(g,10,function(H,z,J,L,K){we(Math.floor((K-J-z)/K*100)),(H==="FAILED"||H==="SUCCESS")&&Pe&&(L===0?me.open({type:"success",content:"\u6210\u529F\u4E0A\u4F20".concat(K,"\u4E2A\u6587\u4EF6")}):K>L?me.open({type:"warning",content:"\u6210\u529F\u4E0A\u4F20".concat(K-L,"\u4E2A\u6587\u4EF6\uFF0C\u5931\u8D25").concat(L,"\u4E2A")}):me.open({type:"error",content:"".concat(L,"\u4E2A\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}),setTimeout(function(){De(!1),s.target.value=""},700))});X.start()}var ge=(0,n.useRef)(te);(0,n.useEffect)(function(){ge.current=te},[te]);function Je(s,g,d){return he.apply(this,arguments)}function he(){return he=h()(i()().mark(function s(g,d,G){var X,H,z,J,L,K,V,Ce,Te;return i()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(y.prev=0,!ae.current){y.next=7;break}return y.next=4,(0,ee.oP)(g);case 4:X=y.sent,y.next=8;break;case 7:X=g.name;case 8:return H={time:+new Date,id:d,file:g,size:g.size,state:"PENDING",directory:G},ne(function(ue){return[H].concat(k()(ue))}),y.next=12,xe.put("/web/".concat(R.current?R.current+"/":"")+X,g);case 12:z=y.sent,J="https://cdn.meiqijiacheng.com/"+z.name,L=k()(ge.current),K=L.find(function(ue){return ue.id===d}),K.state="SUCCESS",K.url=J,V=0;case 19:if(!(V<L.length)){y.next=27;break}if(!(L[V].size===g.size&&L[V].url===J&&L[V].id!==d)){y.next=24;break}return(0,b.Oy)(L[V].id),L.splice(V,1),y.abrupt("break",27);case 24:V++,y.next=19;break;case 27:ne(k()(L)),Re(R.current),(0,b.B7)(K),y.next=39;break;case 32:throw y.prev=32,y.t0=y.catch(0),Ce=k()(ge.current),Te=Ce.find(function(ue){return ue.id===d}),Te.state="FAILED",ne(Ce),new Error(y.t0);case 39:case"end":return y.stop()}},s,null,[[0,32]])})),he.apply(this,arguments)}var ve=(0,n.useRef)(null);function We(){if(!/^([0-9a-zA-Z]+[/]?[0-9a-zA-Z]+)+$/.test(R.current)&&R.current!==""){_.ZP.error("\u8DEF\u5F84\u53EA\u80FD\u542B\u6709\u82F1\u6587\u548C\u6570\u5B57");return}ve.current&&ve.current.click()}function pe(){return Ee===""?te.sort(function(s,g){return g.time-s.time}):te.filter(function(s){return s.directory===Ee}).sort(function(s,g){return g.time-s.time})}var Ye=(0,n.useState)(1),Le=u()(Ye,2),Se=Le[0],ke=Le[1],Ve=(0,n.useState)(20),Be=u()(Ve,2),de=Be[0],$e=Be[1],qe=(0,n.useState)(""),Ne=u()(qe,2),Ee=Ne[0],Re=Ne[1];function _e(){var s,g,d,G,X,H,z,J;(s=document.querySelector("#dragBox"))===null||s===void 0||s.addEventListener("dragenter",et,!1),(g=document.querySelector("#dragMask"))===null||g===void 0||g.addEventListener("dragleave",nt,!1),(d=document.querySelector("#dragMask"))===null||d===void 0||d.addEventListener("drop",tt,!1),(G=document.querySelector("#dragMask"))===null||G===void 0||G.addEventListener("dragenter",ie,!1),(X=document.querySelector("#dragBox"))===null||X===void 0||X.addEventListener("dragleave",ie,!1),(H=document.querySelector("#dragMask"))===null||H===void 0||H.addEventListener("dragover",ie,!1),(z=document.querySelector("#dragBox"))===null||z===void 0||z.addEventListener("dragover",ie,!1),(J=document.querySelector("#dragBox"))===null||J===void 0||J.addEventListener("drop",ie,!1)}function et(s){s.preventDefault(),s.stopPropagation(),document.querySelector("#dragMask").style.display="flex"}function tt(s){s.preventDefault(),s.stopPropagation(),document.querySelector("#dragMask").style.display="none",Oe({target:{files:s.dataTransfer.files}})}function nt(s){s.preventDefault(),s.stopPropagation(),document.querySelector("#dragMask").style.display="none"}function ie(s){s.preventDefault(),s.stopPropagation()}return(0,m.jsxs)("div",{className:"w-3/4 bg-white rounded-xl shadow-lg mt-8 ml-auto mr-auto p-8",children:[Ze(),(0,m.jsxs)("div",{className:"relative flex mt-8 bg-gray-50 p-8 rounded-xl",id:"dragBox",children:[(0,m.jsx)(v.default,{uploadDirectory:N,setUploadDirectory:U,isNeedHash:x,setIsNeedHash:oe}),re?(0,m.jsx)($.Z,{className:"mt-4 mr-8 w-32 h-32",type:"circle",percent:Ke}):(0,m.jsx)("div",{className:"uploadBtn flex mt-4 mr-8 items-center justify-center w-32 h-32 rounded-full cursor-pointer text-white shadow-xl text-xl  ".concat(O!=="FINISHED"&&"hidden"),onClick:We,children:(0,m.jsxs)("svg",{t:"1669963956354",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5794",width:"50",height:"50",children:[(0,m.jsx)("path",{d:"M873.411765 481.882353a60.235294 60.235294 0 0 1 120.470588 0v283.467294C993.882353 908.107294 878.953412 1024 736.858353 1024H287.141647C145.046588 1024 30.117647 908.107294 30.117647 765.349647V481.882353a60.235294 60.235294 0 1 1 120.470588 0v283.467294C150.588235 841.788235 211.847529 903.529412 287.141647 903.529412h449.716706C812.152471 903.529412 873.411765 841.788235 873.411765 765.349647V481.882353z","p-id":"5795",fill:"#dbdbdb"}),(0,m.jsx)("path",{d:"M451.764706 60.235294m60.235294 0l0 0q60.235294 0 60.235294 60.235294l0 602.352941q0 60.235294-60.235294 60.235295l0 0q-60.235294 0-60.235294-60.235295l0-602.352941q0-60.235294 60.235294-60.235294Z","p-id":"5796",fill:"#dbdbdb"}),(0,m.jsx)("path",{d:"M508.988235 170.345412L338.522353 340.751059a60.235294 60.235294 0 0 1-85.172706-85.172706L466.401882 42.586353a60.235294 60.235294 0 0 1 85.172706 0l212.931765 212.992a60.235294 60.235294 0 1 1-85.172706 85.172706L508.988235 170.345412z","p-id":"5797",fill:"#dbdbdb"})]})}),re?"":(0,m.jsx)("div",{className:"flipAnimation absolute right-14 bottom-8 text-gray-400 text-sm ".concat(O!=="FINISHED"&&"hidden"),children:"\u70B9\u51FB\u4E0A\u4F20\u6216\u62D6\u66F3\u6587\u4EF6\u81F3\u6B64"}),(0,m.jsx)("div",{id:"dragMask",className:"rounded-xl ",children:"\u653E\u624B\u5373\u53EF\u4E0A\u4F20"})]}),(0,m.jsx)(Ae.default,{filesList:te,activeDirectory:Ee,setActiveDirectory:Re,setPage:ke,setUploadDirectory:U,setFilesList:ne}),pe().length?(0,m.jsxs)("div",{className:"mt-8  bg-gray-50 p-8 rounded-xl",children:[(0,m.jsx)("h1",{className:"text-3xl font-bold",children:"\u6587\u4EF6\u5217\u8868:"}),(0,m.jsx)("div",{children:pe().slice((Se-1)*de,(Se-1)*de+de).map(function(s){return(0,m.jsx)(I.default,{file:s.file,url:s.url,state:s.state,time:s.time,size:s.size,id:s.id,setFilesList:ne},s.id)})}),(0,m.jsx)(le.Z,{className:"flex justify-center mt-5",current:Se,defaultCurrent:1,total:pe().length,pageSize:de,onChange:function(g,d){ke(g),$e(d)}})]}):"",(0,m.jsx)("input",{className:"invisible",type:"file",onChange:Oe,multiple:!0,ref:ve}),Xe]})}},61430:function(se,j,e){e.d(j,{B7:function(){return u},Oy:function(){return h},XZ:function(){return A},vO:function(){return B}});var p="uploadRecords",k="SangoUploader",Z=2,i=null;function A(){return new Promise(function(n,v){var I=window.indexedDB.open(k,Z);I.onupgradeneeded=function(a){var t;if(i=a==null||(t=a.target)===null||t===void 0?void 0:t.result,!i.objectStoreNames.contains(p))var l=i.createObjectStore(p,{keyPath:"id"})},I.onsuccess=function(a){var t;i=a==null||(t=a.target)===null||t===void 0?void 0:t.result,n(!0)},I.onerror=function(a){v(a)}})}function u(n){delete n.file;var v=i.transaction(p,"readwrite").objectStore(p).add(n);v.onsuccess=function(){console.log("\u5199\u5165",v.result)},v.onerror=function(I){console.log(I,"\u5199\u5165\u5931\u8D25")}}function B(){return new Promise(function(n,v){var I=i.transaction(p).objectStore(p),a=I.getAll();a.onsuccess=function(t){n(t.target.result)}})}function h(n){var v=i.transaction(p,"readwrite").objectStore(p).delete(n);v.onsuccess=function(){console.log("\u5220\u9664\u6210\u529F",v.result)},v.onerror=function(I){console.log(I,"\u5220\u9664\u5931\u8D25")}}},46126:function(se,j,e){e.d(j,{Kk:function(){return a},oP:function(){return v},r0:function(){return I}});var p=e(9189),k=e.n(p),Z=e(58482),i=e.n(Z),A=e(93275),u=e.n(A),B=e(34847),h=e.n(B),n=e(29485);function v(t){return new Promise(function(l,r){var o=new FileReader;o.readAsArrayBuffer(t),o.onload=function(c){var S,D=c.target.result,P=new(h()).ArrayBuffer().append(D).end(),W=(S=/\.([a-zA-Z0-9]+)$/.exec(t.name))===null||S===void 0?void 0:S[1];l(t.name.replace("."+W,"")+"-"+P.substr(-9)+"."+W)},o.onerror=function(c){r(c)}})}function I(t){var l=document.createElement("input");l.value=t,document.body.appendChild(l),l.select(),document.execCommand("Copy"),document.body.removeChild(l),n.ZP.success("\u590D\u5236URL\u6210\u529F")}var a=function(){function t(l){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,o=arguments.length>2?arguments[2]:void 0;k()(this,t),u()(this,"maxConcurrencyLimit",5),u()(this,"tasks",[]),u()(this,"processingTasks",[]),u()(this,"failedTasks",[]),u()(this,"state","PENDING"),u()(this,"processCallback",void 0),u()(this,"total",0),this.maxConcurrencyLimit=r,this.tasks=l,this.total=l.length,this.processCallback=o,this.handleCallback()}return i()(t,[{key:"start",value:function(){for(this.state="PROCESSING";this.processingTasks.length<this.maxConcurrencyLimit&&this.tasks.length;)this.handleOneTask();var r=Promise.race(this.processingTasks);this.handleRace(r)}},{key:"handleRace",value:function(r){var o=this,c=function(){o.tasks.length&&o.processingTasks.length<o.maxConcurrencyLimit&&(o.handleOneTask(),o.handleRace(Promise.race(o.processingTasks)))};r.then(c,c)}},{key:"handleOneTask",value:function(){var r=this,o=this.tasks.shift(),c=o();c.then(function(){r.processingTasks.splice(r.processingTasks.findIndex(function(S){return S===c}),1),r.checkFinallyState()},function(S){console.log(S);var D=r.processingTasks.findIndex(function(P){return P===c});r.processingTasks.splice(D,1),r.failedTasks.push(o),r.checkFinallyState()}),this.processingTasks.push(c)}},{key:"checkFinallyState",value:function(){!this.tasks.length&&!this.processingTasks.length?(this.failedTasks.length?this.state="FAILED":this.state="SUCCESS",this.handleCallback()):this.handleCallback()}},{key:"handleCallback",value:function(){this.processCallback&&this.processCallback(this.state,this.processingTasks.length,this.tasks.length,this.failedTasks.length,this.total)}}]),t}()}}]);
