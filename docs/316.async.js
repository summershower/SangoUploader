"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[316,77,907],{72451:function(X,O,e){e.r(O),e.d(O,{default:function(){return u}});var F="data:image/png;base64,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",N=e(46126),R=e(67880),c=e.n(R),m=e(31026),o=e.n(m),n=e(62086),E=e(2236);c().extend(E).locale(o());function u(D){var d=D.url,U=D.state,h=D.file,t=D.index,s=D.time,f=D.setFilesList,v=function(){return{animationDelay:t*.05+"s"}};function I(){}return U==="PENDING"?(0,n.jsxs)("div",{className:"flipAnimation flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",style:v(),children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm  ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(d??"")?URL.createObjectURL(h):F}),(0,n.jsx)("div",{className:"flex-1 flex items-center ml-4 break-all",children:"\u4E0A\u4F20\u4E2D..."})]}):U==="SUCCESS"?(0,n.jsxs)("div",{className:"flipAnimation relative flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",onClick:function(){return(0,N.r0)(d??"")},style:v(),children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(d||"")?d:F}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-start h-24 ml-4 ",children:[(0,n.jsxs)("div",{children:[d," "]}),(0,n.jsxs)("div",{className:"text-xs text-gray-400 mt-2",children:["\u4E0A\u4F20\u65F6\u95F4\uFF1A",c()(s).format("YYYY-MM-DD HH:mm:ss")," (",c()(s).fromNow(),")"]})]}),(0,n.jsx)("div",{className:"absolute right-4 top-4 rounded-full bg-gray-400 transition-all w-6 h-6 text-white flex justify-center items-center hover:bg-gray-500",children:"X"})]}):(0,n.jsxs)("div",{className:"flipAnimation flex p-3 mt-6 bg-red-100 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",style:v(),children:[(0,n.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(d??"")?URL.createObjectURL(h):F}),(0,n.jsx)("div",{className:"flex-1 flex items-center ml-4 break-all",children:"\u4E0A\u4F20\u5931\u8D25"})]})}},39757:function(X,O,e){e.r(O),e.d(O,{default:function(){return o}});var F=e(46686),N=e.n(F),R=e(83768),c=e(93236),m=e(62086);function o(n){var E=n.uploadDirectory,u=n.setUploadDirectory,D=n.isNeedHash,d=n.setIsNeedHash,U=function(P){d(P.target.checked)},h=(0,c.useState)(v()),t=N()(h,2),s=t[0],f=t[1];function v(){for(var I="",P=0;P<10;P++)I+=Math.random().toString(36).substr(2,1);return(0,m.jsxs)("span",{className:"text-blue-600",children:["-",I]})}return(0,m.jsxs)("div",{className:"flex-1 items-center",children:[(0,m.jsx)("h1",{className:"text-3xl font-bold",children:"\u914D\u7F6E\u9879\uFF1A"}),(0,m.jsxs)("div",{className:"flex items-center mt-8",children:[(0,m.jsx)("h2",{children:"\u4E0A\u4F20\u76EE\u5F55\uFF1A"}),(0,m.jsx)("b",{children:"/web/"}),(0,m.jsx)("input",{onChange:function(P){return u(P.target.value)},value:E,className:"border-transparent w-64 h-10 ml-2 pl-4 pr-4 bg-gray-200 rounded-md text-pink-600 text-2xl outline-none focus:ring focus:border-blue-200 focus:bg-gray-200 shadow-sm focus:shadow-md transition-all",type:"text","max-length":"20"}),(0,m.jsx)("b",{className:"ml-2",children:"/"})]}),(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)(R.Z,{checked:D,onChange:U,children:"\u8FFD\u52A0\u6587\u4EF6\u54C8\u5E0C\u503C"})}),(0,m.jsxs)("div",{className:"mt-4 text-gray-500",children:["\u6700\u7EC8\u8DEF\u5F84\u793A\u4F8B\uFF1A https://cdn.meiqijiahceng.com/web/",(0,m.jsx)("span",{className:"text-pink-600",children:E?E+"/":""}),"sample",D?s:"",".png"]})]})}},97917:function(X,O,e){e.r(O);var F=e(94434),N=e.n(F),R=e(93236),c=e(62086),m=function(n){var E=n.filesList,u=n.activeDirectory,D=n.setActiveDirectory,d=n.setPage,U=n.setUploadDirectory,h=(0,R.useMemo)(function(){for(var t=new Set,s=0;s<E.length;s++)t.add(E[s].directory);return N()(t)},[E.length]);return E.length?(0,c.jsxs)("div",{className:"flex flex-wrap ",children:[(0,c.jsx)("div",{onClick:function(){D(""),d(1),U("test")},className:"mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(u===""&&"bg-blue-100"),children:"\u5168\u90E8"}),h.map(function(t){return(0,c.jsx)("div",{className:"mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(u===t&&"bg-blue-100"),onClick:function(){D(t),d(1),U(t)},children:t},t)})]}):(0,c.jsx)("div",{})};O.default=m},97316:function(X,O,e){e.r(O),e.d(O,{default:function(){return Ue}});var F=e(94434),N=e.n(F),R=e(35290),c=e.n(R),m=e(46686),o=e.n(m),n=e(411),E=e.n(n),u=e(93236),D=e(39757),d=e(72451),U=e(93275),h=e.n(U),t=e(9189),s=e.n(t),f=e(58482),v=e.n(f),I=e(30365),P=e.n(I),Q=function(){return new Promise(function(A,a){P().get("http://dev-gapi.meiqijiacheng.com:810/configure/getSTS?objectName=web").then(function(l){A(l.data.data)}).catch(function(l){a(l)})})},Y=e(21156),Je=null;function Xe(){return ne.apply(this,arguments)}function ne(){return ne=_asyncToGenerator(_regeneratorRuntime().mark(function p(){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(){var l=_asyncToGenerator(_regeneratorRuntime().mark(function r(j,_){var k;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,getOSSConfig;case 3:k=x.sent,j(k),x.next=10;break;case 7:x.prev=7,x.t0=x.catch(0),_(x.t0);case 10:case"end":return x.stop()}},r,null,[[0,7]])}));return function(r,j){return l.apply(this,arguments)}}()));case 1:case"end":return a.stop()}},p)})),ne.apply(this,arguments)}var Ie=function(){function p(){s()(this,p),h()(this,"oss",null),h()(this,"invalidTime",0)}return v()(p,[{key:"getOSS",value:function(){var a=this;return new Promise(function(){var l=E()(c()().mark(function r(j,_){return c()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(+new Date<a.invalidTime)){S.next=4;break}j(a.oss),S.next=13;break;case 4:return S.prev=4,S.next=7,a.initOSS();case 7:j(a.oss),S.next=13;break;case 10:S.prev=10,S.t0=S.catch(4),_(S.t0);case 13:case"end":return S.stop()}},r,null,[[4,10]])}));return function(r,j){return l.apply(this,arguments)}}())}},{key:"initOSS",value:function(){var a=this;return new Promise(function(){var l=E()(c()().mark(function r(j,_){var k,S,x,V,H,$;return c()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,L.next=3,Q();case 3:k=L.sent,S=k.aLiYunHost,x=k.accessKeyId,V=k.accessKeySecret,H=k.bucketName,$=k.securityToken,a.oss=new Y({region:S.replace(".aliyuncs.com",""),accessKeyId:x,accessKeySecret:V,stsToken:$,bucket:H}),a.invalidTime=+new Date+36e5,j(!0),L.next=14;break;case 10:L.prev=10,L.t0=L.catch(0),console.log(L.t0),_("\u8BF7\u6C42OSS\u914D\u7F6E\u51FA\u9519");case 14:case"end":return L.stop()}},r,null,[[0,10]])}));return function(r,j){return l.apply(this,arguments)}}())}}]),p}(),B="uploadRecords",xe="SangoUploader",ye=1,T=null;function be(){return new Promise(function(p,A){var a=window.indexedDB.open(xe,ye);a.onupgradeneeded=function(l){var r;if(T=l==null||(r=l.target)===null||r===void 0?void 0:r.result,!T.objectStoreNames.contains(B))var j=T.createObjectStore(B,{keyPath:"time"})},a.onsuccess=function(l){var r;T=l==null||(r=l.target)===null||r===void 0?void 0:r.result,p(!0)},a.onerror=function(l){A(l)}})}function Pe(p){delete p.file;var A=T.transaction(B,"readwrite").objectStore(B).add(p);A.onsuccess=function(){console.log("\u5199\u5165ed",A.result)},A.onerror=function(a){console.log(a,"\u5199\u5165\u5931\u8D25")}}function Oe(){return new Promise(function(p,A){var a=T.transaction(B).objectStore(B),l=a.getAll();l.onsuccess=function(r){p(r.target.result)}})}function Ye(p){delete p.file;var A=T.transaction(B,"readwrite").objectStore(B).delete(p);A.onsuccess=function(){console.log("\u5199\u5165ed",A.result)},A.onerror=function(a){console.log(a,"\u5220\u9664\u5931\u8D25")}}var je=e(41394),ke=e(98495),Le=e(35211),ce=e(46126),Ne=e(97917),y=e(62086),Fe=new Ie,de;function Ue(){function p(){return A.apply(this,arguments)}function A(){return A=E()(c()().mark(function i(){return c()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,Fe.getOSS();case 3:de=g.sent,se("FINISHED"),g.next=10;break;case 7:g.prev=7,g.t0=g.catch(0),se("ERROR");case 10:case"end":return g.stop()}},i,null,[[0,7]])})),A.apply(this,arguments)}(0,u.useEffect)(function(){p(),be().then(function(){Oe().then(function(i){w(i)})})},[]);var a=(0,u.useState)("test"),l=o()(a,2),r=l[0],j=l[1],_=(0,u.useState)(!0),k=o()(_,2),S=k[0],x=k[1],V=(0,u.useState)("LOADING"),H=o()(V,2),$=H[0],se=H[1],L=function(){switch($){case"LOADING":return(0,y.jsx)("h1",{className:"text-xl text-gray-400",children:"\u6B63\u5728\u52A0\u8F7DOSS\u7EC4\u4EF6..."});case"FINISHED":return(0,y.jsx)("h1",{className:"text-xl text-green-600",children:"OSS\u521D\u59CB\u5316\u5B8C\u6BD5\u2714"});case"ERROR":return(0,y.jsx)("h1",{className:"text-xl text-pink-600 cursor-pointer",onClick:function(){return location.reload()},children:"\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u8BD5\xD7"})}},Re=(0,u.useState)(!1),Ae=o()(Re,2),Be=Ae[0],me=Ae[1],Te=(0,u.useState)([]),ge=o()(Te,2),M=ge[0],w=ge[1],_e=(0,u.useState)(0),he=o()(_e,2),Me=he[0],Ze=he[1];function Ke(i){for(var C=[],g=function(W){C.push(function(){return Qe(i.target.files[W],Math.floor(Math.random()*1e16),r)})},K=0;K<i.target.files.length;K++)g(K);me(!0);var z=new ce.Kk(C,10,function(G,W,ee,te,Z){Ze(Math.floor((Z-ee)/Z*100)),me(!1)});setTimeout(function(){z.start()},2e3)}var fe=(0,u.useRef)(M);(0,u.useEffect)(function(){fe.current=M},[M]);function Qe(i,C,g){return ae.apply(this,arguments)}function ae(){return ae=E()(c()().mark(function i(C,g,K){var z,G,W,ee,te,Z,ue,De;return c()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(b.prev=0,!S){b.next=7;break}return b.next=4,(0,ce.oP)(C);case 4:z=b.sent,b.next=8;break;case 7:z=C.name;case 8:return G={time:+new Date,id:g,file:C,state:"PENDING",directory:K},w(function(J){return[G].concat(N()(J))}),b.next=12,de.put("/web/".concat(r?r+"/":"")+z,C);case 12:W=b.sent,ee="https://cdn.meiqijiacheng.com/"+W.name,te=N()(fe.current),Z=te.find(function(J){return J.id===g}),Z.state="SUCCESS",Z.url=ee,w(N()(te)),Ee(r),Pe(Z),b.next=30;break;case 23:throw b.prev=23,b.t0=b.catch(0),ue=M,De=ue.find(function(J){return J.id===g})||{time:+new Date,id:g,file:C,state:"FAILED",directory:K},De.state="FAILED",w(N()(ue)),new Error(b.t0);case 30:case"end":return b.stop()}},i,null,[[0,23]])})),ae.apply(this,arguments)}var re=(0,u.useRef)(null);function He(){if(!/^([0-9a-zA-Z]+[/]?[0-9a-zA-Z]+)+$/.test(r)&&r!==""){je.ZP.error("\u8DEF\u5F84\u53EA\u80FD\u542B\u6709\u82F1\u6587\u548C\u6570\u5B57");return}re.current&&re.current.click()}function le(){return oe===""?M.sort(function(i,C){return C.time-i.time}):M.filter(function(i){return i.directory===oe}).sort(function(i,C){return C.time-i.time})}var we=(0,u.useState)(1),ve=o()(we,2),ie=ve[0],pe=ve[1],ze=(0,u.useState)(20),Se=o()(ze,2),q=Se[0],Ge=Se[1],We=(0,u.useState)(""),Ce=o()(We,2),oe=Ce[0],Ee=Ce[1];return(0,y.jsxs)("div",{className:"w-3/4 bg-white rounded-xl shadow-lg mt-8 ml-auto mr-auto p-8 ",children:[L(),(0,y.jsxs)("div",{className:"flex mt-8 bg-gray-50 p-8 rounded-xl",children:[(0,y.jsx)(D.default,{uploadDirectory:r,setUploadDirectory:j,isNeedHash:S,setIsNeedHash:x}),Be?(0,y.jsx)(ke.Z,{className:"mt-10 mr-8 w-32 h-32",type:"circle",percent:Me}):(0,y.jsx)("div",{className:"flex mt-10 mr-8 items-center justify-center bg-green-500 w-32 h-32 rounded-full cursor-pointer text-white shadow-xl text-xl transition-all hover:bg-green-600",onClick:He,children:"\u7ACB\u5373\u4E0A\u4F20"})]}),(0,y.jsx)(Ne.default,{filesList:M,activeDirectory:oe,setActiveDirectory:Ee,setPage:pe,setUploadDirectory:j}),le().length?(0,y.jsxs)("div",{className:"mt-8  bg-gray-50 p-8 rounded-xl",children:[(0,y.jsx)("h1",{className:"text-3xl font-bold",children:"\u6587\u4EF6\u5217\u8868:"}),(0,y.jsx)("div",{children:le().slice((ie-1)*q,(ie-1)*q+q).map(function(i,C){return(0,y.jsx)(d.default,{file:i.file,url:i.url,state:i.state,index:C,time:i.time,setFilesList:w},i.id)})}),(0,y.jsx)(Le.Z,{className:"flex justify-center mt-5",current:ie,defaultCurrent:1,total:le().length,pageSize:q,onChange:function(C,g){pe(C),Ge(g)}})]}):"",(0,y.jsx)("input",{className:"invisible",type:"file",onChange:Ke,multiple:!0,ref:re})]})}},46126:function(X,O,e){e.d(O,{Kk:function(){return U},oP:function(){return D},r0:function(){return d}});var F=e(9189),N=e.n(F),R=e(58482),c=e.n(R),m=e(93275),o=e.n(m),n=e(34847),E=e.n(n),u=e(41394);function D(h){return new Promise(function(t,s){var f=new FileReader;f.readAsArrayBuffer(h),f.onload=function(v){var I,P=v.target.result,Q=new(E()).ArrayBuffer().append(P).end(),Y=(I=/\.([a-zA-Z0-9]+)$/.exec(h.name))===null||I===void 0?void 0:I[1];t(h.name.replace("."+Y,"")+"-"+Q.substr(-9)+"."+Y)},f.onerror=function(v){s(v)}})}function d(h){var t=document.createElement("input");t.value=h,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t),u.ZP.success("\u590D\u5236URL\u6210\u529F")}var U=function(){function h(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,f=arguments.length>2?arguments[2]:void 0;N()(this,h),o()(this,"maxConcurrencyLimit",5),o()(this,"tasks",[]),o()(this,"processingTasks",[]),o()(this,"failedTasks",[]),o()(this,"state","PENDING"),o()(this,"processCallback",void 0),o()(this,"total",0),this.maxConcurrencyLimit=s,this.tasks=t,this.total=t.length,this.processCallback=f,this.handleCallback()}return c()(h,[{key:"start",value:function(){for(this.state="PROCESSING";this.processingTasks.length<this.maxConcurrencyLimit&&this.tasks.length;)this.handleOneTask();var s=Promise.race(this.processingTasks);this.handleRace(s)}},{key:"handleRace",value:function(s){var f=this,v=function(){f.tasks.length&&f.processingTasks.length<f.maxConcurrencyLimit&&(f.handleOneTask(),f.handleRace(Promise.race(f.processingTasks)))};s.then(v,v)}},{key:"handleOneTask",value:function(){var s=this,f=this.tasks.shift(),v=f();v.then(function(){s.processingTasks.splice(s.processingTasks.findIndex(function(I){return I===v}),1),s.checkFinallyState()},function(I){console.log(I);var P=s.processingTasks.findIndex(function(Q){return Q===v});s.processingTasks.splice(P,1),s.failedTasks.push(f),s.checkFinallyState()}),this.processingTasks.push(v)}},{key:"checkFinallyState",value:function(){!this.tasks.length&&!this.processingTasks.length&&(this.failedTasks.length?(console.log("Race\uFF1A\u6709\u5931\u8D25\u4EFB\u52A1"),this.state="FAILED"):(console.log("Race: \u4EFB\u52A1\u5B8C\u6210 "),this.state="SUCCESS")),this.handleCallback()}},{key:"handleCallback",value:function(){this.processCallback&&this.processCallback(this.state,this.processingTasks.length,this.tasks.length,this.failedTasks.length,this.total)}}]),h}()}}]);
