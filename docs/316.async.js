"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[316,77,907],{72451:function(ee,O,e){e.r(O),e.d(O,{default:function(){return U}});var N="data:image/png;base64,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",j=e(46126),B=e(67880),g=e.n(B),f=e(93236),m=e(31026),D=e.n(m),t=e(62086),l=e(2236);g().extend(l).locale(D());function U(y){var h=y.url,p=y.state,i=y.file,o=y.time,c=y.size,s=y.setFilesList;function n(){}var u=(0,f.useRef)(null);return(0,f.useEffect)(function(){var R=new IntersectionObserver(function(Z){if(Z[0].isIntersecting){var te;(te=u.current)===null||te===void 0||te.classList.add("flipAnimation"),R.disconnect()}});R.observe(u.current)},[u.current]),p==="PENDING"?(0,t.jsxs)("div",{className:"flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",ref:u,children:[(0,t.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm  ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(h??"")?URL.createObjectURL(i):N}),(0,t.jsx)("div",{className:"flex-1 flex items-center ml-4 break-all",children:"\u4E0A\u4F20\u4E2D..."})]}):p==="SUCCESS"?(0,t.jsxs)("div",{className:" relative flex p-3 mt-6 bg-gray-200 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",onClick:function(){return(0,j.r0)(h??"")},ref:u,children:[(0,t.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(h||"")?h:N}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-start h-24 ml-4 ",children:[(0,t.jsxs)("div",{children:[h," "]}),(0,t.jsxs)("div",{className:"text-xs text-gray-400 mt-2",children:["\u6587\u4EF6\u5927\u5C0F: ",c/1024>1024?(c/1024/1024).toFixed(2)+"Mb":(c/1024).toFixed(2)+"kb","\xA0\xA0\xA0\u4E0A\u4F20\u65F6\u95F4\uFF1A",g()(o).format("YYYY-MM-DD HH:mm:ss")," (",g()(o).fromNow(),")"]})]})]}):(0,t.jsxs)("div",{className:" flex p-3 mt-6 bg-red-100 rounded-xl hover:bg-gray-300 transition-all cursor-pointer",ref:u,children:[(0,t.jsx)("img",{className:"rounded-xl w-24 h-24 object-cover filter blur-sm ",src:/png|jpg|jpeg|png|webp|bmp|svg/i.test(h??"")?URL.createObjectURL(i):N}),(0,t.jsx)("div",{className:"flex-1 flex items-center ml-4 break-all",children:"\u4E0A\u4F20\u5931\u8D25"})]})}},39757:function(ee,O,e){e.r(O),e.d(O,{default:function(){return m}});var N=e(46686),j=e.n(N),B=e(83768),g=e(93236),f=e(62086);function m(D){var t=D.uploadDirectory,l=D.setUploadDirectory,U=D.isNeedHash,y=D.setIsNeedHash,h=function(u){y(u.target.checked)},p=(0,g.useState)(s()),i=j()(p,2),o=i[0],c=i[1];function s(){for(var n="",u=0;u<10;u++)n+=Math.random().toString(36).substr(2,1);return(0,f.jsxs)("span",{className:"text-blue-600",children:["-",n]})}return(0,f.jsxs)("div",{className:"flex-1 items-center",children:[(0,f.jsx)("h1",{className:"text-3xl font-bold",children:"\u914D\u7F6E\u9879\uFF1A"}),(0,f.jsxs)("div",{className:"flex items-center mt-8",children:[(0,f.jsx)("h2",{children:"\u4E0A\u4F20\u76EE\u5F55\uFF1A"}),(0,f.jsx)("b",{children:"/web/"}),(0,f.jsx)("input",{onChange:function(u){return l(u.target.value)},value:t,className:"border-transparent w-64 h-10 ml-2 pl-4 pr-4 bg-gray-200 rounded-md text-pink-600 text-2xl outline-none focus:ring focus:border-blue-200 focus:bg-gray-200 shadow-sm focus:shadow-md transition-all",type:"text","max-length":"20"}),(0,f.jsx)("b",{className:"ml-2",children:"/"})]}),(0,f.jsx)("div",{className:"mt-4",children:(0,f.jsx)(B.Z,{checked:U,onChange:h,children:"\u8FFD\u52A0\u6587\u4EF6\u54C8\u5E0C\u503C"})}),(0,f.jsxs)("div",{className:"mt-4 text-gray-500",children:["\u6700\u7EC8\u8DEF\u5F84\u793A\u4F8B\uFF1A https://cdn.meiqijiahceng.com/web/",(0,f.jsx)("span",{className:"text-pink-600",children:t?t+"/":""}),"sample",U?o:"",".png"]})]})}},97917:function(ee,O,e){e.r(O);var N=e(46686),j=e.n(N),B=e(93236),g=e(62086),f=function(D){var t=D.filesList,l=D.activeDirectory,U=D.setActiveDirectory,y=D.setPage,h=D.setUploadDirectory,p=(0,B.useState)({}),i=j()(p,2),o=i[0],c=i[1];return(0,B.useEffect)(function(){for(var s={},n=0;n<t.length;n++)s[t[n].directory]?(s[t[n].directory].count++,s[t[n].directory].lastModified<t[n].time&&(s[t[n].directory].lastModified=t[n].time)):s[t[n].directory]={count:1,lastModified:t[n].time,directory:t[n].directory},c(s)},[t.length]),t.length?(0,g.jsxs)("div",{className:"flex flex-wrap ",children:[(0,g.jsxs)("div",{onClick:function(){U(""),y(1),h("test")},className:"mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(l===""&&"bg-blue-100"),children:["\u5168\u90E8(",t.length,")"]}),Object.entries(o).sort(function(s,n){return n[1].lastModified-s[1].lastModified}).map(function(s){var n=j()(s,2),u=n[0],R=n[1];return(0,g.jsxs)("div",{className:"mr-5 bg-gray-40 pt-4 pb-4 pl-8 pr-8 shadow-sm bg-gray-50 text-gray-800 cursor-pointer rounded-xl mt-5 transition-all hover:bg-blue-100 ".concat(l===u&&"bg-blue-100"),onClick:function(){U(u),y(1),h(u)},children:[u,"(",R.count,")"]},u)})]}):(0,g.jsx)("div",{})};O.default=f},97316:function(ee,O,e){e.r(O),e.d(O,{default:function(){return Me}});var N=e(94434),j=e.n(N),B=e(35290),g=e.n(B),f=e(46686),m=e.n(f),D=e(411),t=e.n(D),l=e(93236),U=e(39757),y=e(72451),h=e(93275),p=e.n(h),i=e(9189),o=e.n(i),c=e(58482),s=e.n(c),n=e(30365),u=e.n(n),R=function(){return new Promise(function(v,a){u().get("https://gapi.meiqijiacheng.com/configure/getSTS?objectName=web").then(function(d){v(d.data.data)}).catch(function(d){a(d)})})},Z=e(21156),te=null;function et(){return ae.apply(this,arguments)}function ae(){return ae=_asyncToGenerator(_regeneratorRuntime().mark(function S(){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(){var d=_asyncToGenerator(_regeneratorRuntime().mark(function r(F,Q){var k;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,getOSSConfig;case 3:k=x.sent,F(k),x.next=10;break;case 7:x.prev=7,x.t0=x.catch(0),Q(x.t0);case 10:case"end":return x.stop()}},r,null,[[0,7]])}));return function(r,F){return d.apply(this,arguments)}}()));case 1:case"end":return a.stop()}},S)})),ae.apply(this,arguments)}var je=function(){function S(){o()(this,S),p()(this,"oss",null),p()(this,"invalidTime",0)}return s()(S,[{key:"getOSS",value:function(){var a=this;return new Promise(function(){var d=t()(g()().mark(function r(F,Q){return g()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(+new Date<a.invalidTime)){E.next=4;break}F(a.oss),E.next=13;break;case 4:return E.prev=4,E.next=7,a.initOSS();case 7:F(a.oss),E.next=13;break;case 10:E.prev=10,E.t0=E.catch(4),Q(E.t0);case 13:case"end":return E.stop()}},r,null,[[4,10]])}));return function(r,F){return d.apply(this,arguments)}}())}},{key:"initOSS",value:function(){var a=this;return new Promise(function(){var d=t()(g()().mark(function r(F,Q){var k,E,x,ne,G,W;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,L.next=3,R();case 3:k=L.sent,E=k.aLiYunHost,x=k.accessKeyId,ne=k.accessKeySecret,G=k.bucketName,W=k.securityToken,a.oss=new Z({region:E.replace(".aliyuncs.com",""),accessKeyId:x,accessKeySecret:ne,stsToken:W,bucket:G}),a.invalidTime=+new Date+36e5,F(!0),L.next=14;break;case 10:L.prev=10,L.t0=L.catch(0),console.log(L.t0),Q("\u8BF7\u6C42OSS\u914D\u7F6E\u51FA\u9519");case 14:case"end":return L.stop()}},r,null,[[0,10]])}));return function(r,F){return d.apply(this,arguments)}}())}}]),S}(),M="uploadRecords",Fe="SangoUploader",ke=1,K=null;function Le(){return new Promise(function(S,v){var a=window.indexedDB.open(Fe,ke);a.onupgradeneeded=function(d){var r;if(K=d==null||(r=d.target)===null||r===void 0?void 0:r.result,!K.objectStoreNames.contains(M))var F=K.createObjectStore(M,{keyPath:"time"})},a.onsuccess=function(d){var r;K=d==null||(r=d.target)===null||r===void 0?void 0:r.result,S(!0)},a.onerror=function(d){v(d)}})}function Ne(S){delete S.file;var v=K.transaction(M,"readwrite").objectStore(M).add(S);v.onsuccess=function(){console.log("\u5199\u5165ed",v.result)},v.onerror=function(a){console.log(a,"\u5199\u5165\u5931\u8D25")}}function Ue(){return new Promise(function(S,v){var a=K.transaction(M).objectStore(M),d=a.getAll();d.onsuccess=function(r){S(r.target.result)}})}function tt(S){delete S.file;var v=K.transaction(M,"readwrite").objectStore(M).delete(S);v.onsuccess=function(){console.log("\u5199\u5165ed",v.result)},v.onerror=function(a){console.log(a,"\u5220\u9664\u5931\u8D25")}}var ge=e(41394),Re=e(98495),Te=e(35211),fe=e(46126),Be=e(97917),b=e(62086),_e=new je,he;function Me(){function S(){return v.apply(this,arguments)}function v(){return v=t()(g()().mark(function A(){return g()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.prev=0,C.next=3,_e.getOSS();case 3:he=C.sent,re("FINISHED"),C.next=10;break;case 7:C.prev=7,C.t0=C.catch(0),re("ERROR");case 10:case"end":return C.stop()}},A,null,[[0,7]])})),v.apply(this,arguments)}(0,l.useEffect)(function(){S(),Le().then(function(){Ue().then(function(A){X(A)})})},[]);var a=(0,l.useState)("test"),d=m()(a,2),r=d[0],F=d[1],Q=(0,l.useState)(!0),k=m()(Q,2),E=k[0],x=k[1],ne=(0,l.useState)("LOADING"),G=m()(ne,2),W=G[0],re=G[1],L=function(){switch(W){case"LOADING":return(0,b.jsx)("h1",{className:"text-xl text-gray-400",children:"\u6B63\u5728\u52A0\u8F7DOSS\u7EC4\u4EF6..."});case"FINISHED":return(0,b.jsx)("h1",{className:"text-xl text-green-600",children:"OSS\u521D\u59CB\u5316\u5B8C\u6BD5\u2714"});case"ERROR":return(0,b.jsx)("h1",{className:"text-xl text-pink-600 cursor-pointer",onClick:function(){return location.reload()},children:"\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u8BD5\xD7"})}},Ze=(0,l.useState)(!1),ve=m()(Ze,2),J=ve[0],pe=ve[1],Ke=(0,l.useState)([]),Se=m()(Ke,2),w=Se[0],X=Se[1],Qe=(0,l.useState)(0),Ee=m()(Qe,2),He=Ee[0],ze=Ee[1],we=ge.ZP.useMessage(),Ce=m()(we,2),le=Ce[0],Ge=Ce[1],Ie=(0,l.useRef)(J);(0,l.useEffect)(function(){Ie.current=J},[J]),(0,l.useEffect)(function(){console.log(J)});function We(A){pe(!0);for(var I=[],C=function(z){I.push(function(){return Je(A.target.files[z],Math.floor(Math.random()*1e16),r)})},Y=0;Y<A.target.files.length;Y++)C(Y);var V=new fe.Kk(I,10,function(H,z,$,_,T){ze(Math.floor((T-$-z)/T*100)),(H==="FAILED"||H==="SUCCESS")&&Ie&&(console.log(H,z,$,_,T),_===0?le.open({type:"success",content:"\u6210\u529F\u4E0A\u4F20".concat(T,"\u4E2A\u6587\u4EF6")}):T>_?le.open({type:"warning",content:"\u6210\u529F\u4E0A\u4F20".concat(T-_,"\u4E2A\u6587\u4EF6\uFF0C\u5931\u8D25").concat(_,"\u4E2A")}):le.open({type:"error",content:"".concat(_,"\u4E2A\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}),pe(!1))});V.start()}var ie=(0,l.useRef)(w);(0,l.useEffect)(function(){ie.current=w},[w]);function Je(A,I,C){return ue.apply(this,arguments)}function ue(){return ue=t()(g()().mark(function A(I,C,Y){var V,H,z,$,_,T,me,Oe;return g()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(P.prev=0,!E){P.next=7;break}return P.next=4,(0,fe.oP)(I);case 4:V=P.sent,P.next=8;break;case 7:V=I.name;case 8:return H={time:+new Date,id:C,file:I,size:I.size,state:"PENDING",directory:Y},X(function(q){return[H].concat(j()(q))}),P.next=12,he.put("/web/".concat(r?r+"/":"")+V,I);case 12:z=P.sent,$="https://cdn.meiqijiacheng.com/"+z.name,_=j()(ie.current),T=_.find(function(q){return q.id===C}),T.state="SUCCESS",T.url=$,X(j()(_)),Pe(r),Ne(T),P.next=30;break;case 23:throw P.prev=23,P.t0=P.catch(0),me=j()(ie.current),Oe=me.find(function(q){return q.id===C}),Oe.state="FAILED",X(me),new Error(P.t0);case 30:case"end":return P.stop()}},A,null,[[0,23]])})),ue.apply(this,arguments)}var oe=(0,l.useRef)(null);function Xe(){if(!/^([0-9a-zA-Z]+[/]?[0-9a-zA-Z]+)+$/.test(r)&&r!==""){ge.ZP.error("\u8DEF\u5F84\u53EA\u80FD\u542B\u6709\u82F1\u6587\u548C\u6570\u5B57");return}oe.current&&oe.current.click()}function ce(){return Ae===""?w.sort(function(A,I){return I.time-A.time}):w.filter(function(A){return A.directory===Ae}).sort(function(A,I){return I.time-A.time})}var Ye=(0,l.useState)(1),De=m()(Ye,2),de=De[0],xe=De[1],Ve=(0,l.useState)(20),ye=m()(Ve,2),se=ye[0],$e=ye[1],qe=(0,l.useState)(""),be=m()(qe,2),Ae=be[0],Pe=be[1];return(0,b.jsxs)("div",{className:"w-3/4 bg-white rounded-xl shadow-lg mt-8 ml-auto mr-auto p-8 ",children:[L(),(0,b.jsxs)("div",{className:"flex mt-8 bg-gray-50 p-8 rounded-xl",children:[(0,b.jsx)(U.default,{uploadDirectory:r,setUploadDirectory:F,isNeedHash:E,setIsNeedHash:x}),J?(0,b.jsx)(Re.Z,{className:"mt-10 mr-8 w-32 h-32",type:"circle",percent:He}):(0,b.jsx)("div",{className:"flex mt-10 mr-8 items-center justify-center bg-green-500 w-32 h-32 rounded-full cursor-pointer text-white shadow-xl text-xl transition-all hover:bg-green-600 ".concat(W!=="FINISHED"&&"hidden"),onClick:Xe,children:"\u7ACB\u5373\u4E0A\u4F20"})]}),(0,b.jsx)(Be.default,{filesList:w,activeDirectory:Ae,setActiveDirectory:Pe,setPage:xe,setUploadDirectory:F}),ce().length?(0,b.jsxs)("div",{className:"mt-8  bg-gray-50 p-8 rounded-xl",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"\u6587\u4EF6\u5217\u8868:"}),(0,b.jsx)("div",{children:ce().slice((de-1)*se,(de-1)*se+se).map(function(A,I){return(0,b.jsx)(y.default,{file:A.file,url:A.url,state:A.state,time:A.time,size:A.size,setFilesList:X},A.id)})}),(0,b.jsx)(Te.Z,{className:"flex justify-center mt-5",current:de,defaultCurrent:1,total:ce().length,pageSize:se,onChange:function(I,C){xe(I),$e(C)}})]}):"",(0,b.jsx)("input",{className:"invisible",type:"file",onChange:We,multiple:!0,ref:oe}),Ge]})}},46126:function(ee,O,e){e.d(O,{Kk:function(){return h},oP:function(){return U},r0:function(){return y}});var N=e(9189),j=e.n(N),B=e(58482),g=e.n(B),f=e(93275),m=e.n(f),D=e(34847),t=e.n(D),l=e(41394);function U(p){return new Promise(function(i,o){var c=new FileReader;c.readAsArrayBuffer(p),c.onload=function(s){var n,u=s.target.result,R=new(t()).ArrayBuffer().append(u).end(),Z=(n=/\.([a-zA-Z0-9]+)$/.exec(p.name))===null||n===void 0?void 0:n[1];i(p.name.replace("."+Z,"")+"-"+R.substr(-9)+"."+Z)},c.onerror=function(s){o(s)}})}function y(p){var i=document.createElement("input");i.value=p,document.body.appendChild(i),i.select(),document.execCommand("Copy"),document.body.removeChild(i),l.ZP.success("\u590D\u5236URL\u6210\u529F")}var h=function(){function p(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,c=arguments.length>2?arguments[2]:void 0;j()(this,p),m()(this,"maxConcurrencyLimit",5),m()(this,"tasks",[]),m()(this,"processingTasks",[]),m()(this,"failedTasks",[]),m()(this,"state","PENDING"),m()(this,"processCallback",void 0),m()(this,"total",0),this.maxConcurrencyLimit=o,this.tasks=i,this.total=i.length,this.processCallback=c,this.handleCallback()}return g()(p,[{key:"start",value:function(){for(this.state="PROCESSING";this.processingTasks.length<this.maxConcurrencyLimit&&this.tasks.length;)this.handleOneTask();var o=Promise.race(this.processingTasks);this.handleRace(o)}},{key:"handleRace",value:function(o){var c=this,s=function(){c.tasks.length&&c.processingTasks.length<c.maxConcurrencyLimit&&(c.handleOneTask(),c.handleRace(Promise.race(c.processingTasks)))};o.then(s,s)}},{key:"handleOneTask",value:function(){var o=this,c=this.tasks.shift(),s=c();s.then(function(){o.processingTasks.splice(o.processingTasks.findIndex(function(n){return n===s}),1),o.checkFinallyState()},function(n){console.log(n);var u=o.processingTasks.findIndex(function(R){return R===s});o.processingTasks.splice(u,1),o.failedTasks.push(c),o.checkFinallyState()}),this.processingTasks.push(s)}},{key:"checkFinallyState",value:function(){!this.tasks.length&&!this.processingTasks.length?(this.failedTasks.length?this.state="FAILED":this.state="SUCCESS",this.handleCallback()):this.handleCallback()}},{key:"handleCallback",value:function(){this.processCallback&&this.processCallback(this.state,this.processingTasks.length,this.tasks.length,this.failedTasks.length,this.total)}}]),p}()}}]);
